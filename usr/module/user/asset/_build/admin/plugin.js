angular.module("userPluginModule").config(["$routeProvider","piProvider","config",function(a,b,c){function d(a){return c.assetRoot+a+".html"}function e(a){return{data:["$q","$rootScope","server",function(b,c,d){var e=b.defer();return c.alert=2,d[a].get().success(function(b){var d={};d.displayList=b.display_list,d.selectList=b.select_list,d.action=a,e.resolve(d),c.alert=""}),e.promise}]}}a.when("/activity",{templateUrl:d("plugin-activity"),controller:"SortableCtrl",resolve:e("activity")}).when("/quicklink",{templateUrl:d("plugin-quicklink"),controller:"SortableCtrl",resolve:e("quicklink")}).otherwise({redirectTo:"/timeline",templateUrl:d("plugin-timeline"),controller:"TimelineCtrl"}),b.hashPrefix(),b.navTabs(c.navTabs),b.translations(c.t),b.ajaxSetup()}]).service("server",["$http","config",function(a,b){var c=b.urlRoot;this.timeline={get:function(b){return a.get(c+"timeline",{params:{p:b||1}})},put:function(b){return a.post(c+"toggleTimelineDisplay",{id:b.id})}},this.quicklink={get:function(){return a.get(c+"quicklink")},put:function(b){return a.post(c+"dressUpQuicklink",{ids:b})}},this.activity={get:function(){return a.get(c+"activity")},put:function(b){return a.post(c+"dressUpActivity",{ids:b})}}}]).controller("TimelineCtrl",["$scope","server",function(a,b){a.paginator={page:1},a.$watch("paginator.page",function(c){b.timeline.get(c).success(function(b){a.timeline=b.timeline,a.paginator=b.paginator})}),a.disableAction=function(a){a.active&&b.timeline.put(a).success(function(b){b.status&&(a.active=0)})},a.activeAction=function(a){a.active||b.timeline.put(a).success(function(b){b.status&&(a.active=1)})}}]).controller("SortableCtrl",["$scope","data","server",function(a,b,c){function d(){var b=[],c=a.displayList;return angular.forEach(c,function(a){b.push(a.id)}),b=b.join(",")}angular.extend(a,b),a.removeDisplay=function(b){var c=a.displayList[b];a.displayList.splice(b,1),a.selectList.push(c)},a.addDisplay=function(b){var c=a.selectList[b];a.selectList.splice(b,1),a.displayList.push(c)},a.$watch("displayList",function(b,e){b!==e&&c[a.action].put(d())},!0)}]);